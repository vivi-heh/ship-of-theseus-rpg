<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ship of Theseus RPG - Interactive Philosophical Adventure</title>
    <style>
        :root {
            --bg-dark: #0f172a;
            --bg-blue-900: #1e3a8a;
            --bg-blue-800: #1e40af;
            --text-white: #ffffff;
            --text-slate-300: #cbd5e1;
            --text-slate-400: #94a3b8;
            --text-slate-200: #e2e8f0;
            --amber-400: #fbbf24;
            --amber-600: #d97706;
            --blue-400: #60a5fa;
            --blue-600: #2563eb;
            --blue-700: #1d4ed8;
            --green-400: #4ade80;
            --orange-400: #fb923c;
            --orange-100: #fed7aa;
            --orange-200: #fecaca;
            --purple-600: #9333ea;
            --slate-600: #475569;
            --slate-700: #334155;
            --slate-800: #1e293b;
            --ship-original: #8b4513;
            --ship-replaced: #4169e1;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, var(--bg-dark) 0%, var(--bg-blue-900) 50%, var(--bg-blue-800) 100%);
            color: var(--text-white);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .card {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid var(--slate-600);
            border-radius: 0.75rem;
            padding: 1.5rem;
        }

        .title {
            font-size: 2rem;
            text-align: center;
            margin-bottom: 1rem;
            animation: glow-pulse 3s ease-in-out infinite;
        }

        .subtitle {
            text-align: center;
            color: var(--text-slate-300);
            font-style: italic;
            margin-bottom: 1rem;
        }

        .ship-container {
            position: relative;
            width: 100%;
            max-width: 28rem;
            height: 20rem;
            margin: 0 auto 1.5rem;
        }

        .waves {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 5rem;
            pointer-events: none;
        }

        .wave {
            position: absolute;
            width: 100%;
            height: 1rem;
            background: linear-gradient(90deg, transparent 30%, rgba(96, 165, 250, 0.3) 50%, transparent 70%);
            animation: wave-move 6s linear infinite;
        }

        .wave:nth-child(1) {
            bottom: 3rem;
            animation-delay: 0s;
            animation-duration: 6s;
        }

        .wave:nth-child(2) {
            bottom: 3.5rem;
            animation-delay: -2s;
            animation-duration: 8s;
        }

        .wave:nth-child(3) {
            bottom: 4rem;
            animation-delay: -4s;
            animation-duration: 10s;
        }

        .water {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 5rem;
            background: linear-gradient(to top, var(--bg-blue-800), var(--blue-600));
            border-radius: 0 0 3rem 3rem;
            animation: water-wave 3s ease-in-out infinite;
        }

        .ship {
            position: absolute;
            bottom: 3.5rem;
            left: 50%;
            width: 12rem;
            height: 7rem;
            transform: translateX(-50%);
            animation: ship-float 4s ease-in-out infinite;
        }

        .ship-part {
            position: absolute;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            user-select: none;
        }

        .ship-part:hover {
            transform: scale(1.1);
            border-color: var(--amber-400);
            filter: drop-shadow(0 0 10px var(--amber-400));
        }

        .ship-part.original {
            background-color: var(--ship-original);
        }

        .ship-part.replaced {
            background-color: var(--ship-replaced);
        }

        .ship-part.animating {
            animation: part-glow 2s ease-in-out;
        }

        .hull {
            width: 11.25rem;
            height: 2.5rem;
            bottom: 0;
            left: 0.625rem;
            border-radius: 0 0 90px 90px;
        }

        .mast {
            width: 0.5rem;
            height: 3.75rem;
            bottom: 2.5rem;
            left: 50%;
            transform: translateX(-50%);
        }

        .sails {
            width: 3.125rem;
            height: 2.5rem;
            bottom: 3.75rem;
            left: 3.75rem;
            border-radius: 0.625rem;
        }

        .bow {
            width: 1.875rem;
            height: 1.25rem;
            bottom: 1.25rem;
            right: 0;
            clip-path: polygon(0 0, 100% 50%, 0 100%);
        }

        .deck {
            width: 10rem;
            height: 0.9375rem;
            bottom: 2.5rem;
            left: 1.25rem;
            border-radius: 0.3125rem;
        }

        .cabin {
            width: 2.5rem;
            height: 1.5625rem;
            bottom: 3.4375rem;
            left: 1.875rem;
            border-radius: 0.3125rem 0.3125rem 0 0;
        }

        .identity-meter {
            width: 100%;
            margin-bottom: 1rem;
        }

        .identity-labels {
            display: flex;
            justify-content: space-between;
            font-size: 0.875rem;
            color: var(--text-slate-300);
            margin-bottom: 0.5rem;
        }

        .identity-bar {
            width: 100%;
            height: 1rem;
            background-color: var(--slate-700);
            border-radius: 9999px;
            overflow: hidden;
        }

        .identity-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--amber-600) 0%, #dc2626 50%, var(--blue-600) 100%);
            transition: width 0.5s ease;
            border-radius: 9999px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            text-align: center;
        }

        .stat-card {
            background: rgba(51, 65, 85, 0.5);
            padding: 0.75rem;
            border-radius: 0.5rem;
        }

        .stat-label {
            color: var(--text-slate-300);
            font-size: 0.875rem;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
        }

        .game-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .game-stat {
            text-align: center;
            padding: 1.5rem;
        }

        .game-stat-label {
            font-size: 0.875rem;
            color: var(--text-slate-400);
        }

        .game-stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--text-white);
        }

        .progress-bar {
            width: 100%;
            height: 0.5rem;
            background-color: var(--slate-700);
            border-radius: 9999px;
            margin-top: 0.5rem;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background-color: var(--blue-600);
            transition: width 0.3s ease;
        }

        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .badge-secondary {
            background-color: var(--amber-600);
            color: var(--text-white);
        }

        .badge-outline {
            border: 1px solid var(--blue-600);
            color: var(--blue-400);
        }

        .badge-philosophy {
            background-color: var(--purple-600);
            color: var(--text-white);
        }

        .event-card {
            border: 1px solid var(--orange-400);
            background: rgba(154, 52, 18, 0.8);
            backdrop-filter: blur(10px);
        }

        .event-title {
            color: var(--orange-200);
        }

        .event-description {
            color: var(--orange-100);
        }

        .button {
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            border: none;
            font-family: inherit;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .button:hover {
            transform: translateY(-1px);
        }

        .button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .button-primary {
            background-color: var(--blue-600);
            color: var(--text-white);
        }

        .button-primary:hover:not(:disabled) {
            background-color: var(--blue-700);
        }

        .button-outline {
            background: transparent;
            border: 1px solid;
            color: inherit;
        }

        .button-full {
            width: 100%;
        }

        .button-sm {
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
        }

        .choice-button {
            width: 100%;
            text-align: left;
            justify-content: flex-start;
            height: auto;
            padding: 1rem;
            background: rgba(124, 45, 18, 0.5);
            border: 1px solid var(--orange-400);
            color: var(--orange-100);
        }

        .choice-button:hover {
            background: rgba(154, 52, 18, 0.7);
        }

        .repair-button {
            color: #fcd34d;
            border-color: var(--amber-600);
            background: transparent;
        }

        .repair-button:hover:not(:disabled) {
            background: rgba(180, 83, 9, 0.5);
        }

        .replace-button {
            background-color: var(--blue-600);
            color: var(--text-white);
        }

        .replace-button:hover:not(:disabled) {
            background-color: var(--blue-700);
        }

        .control-button {
            background: transparent;
            border: 1px solid;
        }

        .control-amber {
            color: #fcd34d;
            border-color: var(--amber-600);
        }

        .control-amber:hover {
            background: rgba(180, 83, 9, 0.5);
        }

        .control-purple {
            color: #c4b5fd;
            border-color: var(--purple-600);
        }

        .control-purple:hover {
            background: rgba(147, 51, 234, 0.5);
        }

        .two-columns {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }

        .log-container {
            background: rgba(51, 65, 85, 0.5);
            padding: 1rem;
            border-radius: 0.5rem;
            max-height: 12rem;
            overflow-y: auto;
        }

        .log-entry {
            font-size: 0.875rem;
            color: var(--text-slate-200);
            margin-bottom: 0.5rem;
        }

        .separator {
            height: 1px;
            background-color: var(--slate-600);
            margin: 1rem 0;
        }

        .ship-management {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .part-container {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .part-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .part-name {
            font-weight: 500;
            color: var(--text-white);
        }

        .part-condition {
            font-size: 0.875rem;
        }

        .condition-good {
            color: var(--green-400);
        }

        .condition-medium {
            color: #eab308;
        }

        .condition-bad {
            color: #ef4444;
        }

        .part-buttons {
            display: flex;
            gap: 0.5rem;
        }

        .philosophy-panel {
            margin-top: 1rem;
            background: rgba(51, 65, 85, 0.5);
            border: 1px solid var(--slate-600);
        }

        .philosophy-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #c4b5fd;
        }

        .philosophy-text {
            font-size: 0.875rem;
            margin-bottom: 0.5rem;
            color: var(--text-slate-300);
        }

        .philosophy-list {
            font-size: 0.875rem;
            color: var(--text-slate-400);
            list-style: none;
        }

        .philosophy-list li {
            margin-bottom: 0.25rem;
        }

        .philosophy-materialist {
            color: var(--amber-400);
        }

        .philosophy-functionalist {
            color: var(--blue-400);
        }

        .philosophy-experientialist {
            color: var(--green-400);
        }

        .game-over-card {
            max-width: 64rem;
            margin: 0 auto;
            text-align: center;
        }

        .game-over-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .control-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.5rem;
        }

        .hidden {
            display: none;
        }

        @keyframes glow-pulse {

            0%,
            100% {
                text-shadow: 0 0 20px var(--amber-400);
            }

            50% {
                text-shadow: 0 0 30px var(--amber-400), 0 0 40px var(--amber-400);
            }
        }

        @keyframes water-wave {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-5px);
            }
        }

        @keyframes ship-float {

            0%,
            100% {
                transform: translateX(-50%) translateY(0) rotate(-1deg);
            }

            25% {
                transform: translateX(-50%) translateY(-3px) rotate(0deg);
            }

            50% {
                transform: translateX(-50%) translateY(0) rotate(1deg);
            }

            75% {
                transform: translateX(-50%) translateY(-2px) rotate(0deg);
            }
        }

        @keyframes part-glow {
            0% {
                filter: brightness(1);
            }

            50% {
                filter: brightness(1.5) drop-shadow(0 0 15px var(--ship-replaced));
            }

            100% {
                filter: brightness(1);
            }
        }

        @keyframes wave-move {
            0% {
                transform: translateX(-50%);
            }

            100% {
                transform: translateX(0);
            }
        }

        @media (max-width: 768px) {
            .title {
                font-size: 1.5rem;
            }

            .ship-container {
                height: 15rem;
            }

            .ship {
                width: 9rem;
                height: 5.25rem;
            }

            .hull {
                width: 8.4375rem;
                height: 1.875rem;
            }

            .mast {
                height: 2.8125rem;
            }

            .sails {
                width: 2.3125rem;
                height: 1.875rem;
            }

            .deck {
                width: 7.5rem;
                height: 0.75rem;
            }

            .cabin {
                width: 1.875rem;
                height: 1.125rem;
            }

            .two-columns {
                grid-template-columns: 1fr;
            }

            .game-stats {
                grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <div class="container" id="gameContainer">
        <!-- Game content will be inserted here by JavaScript -->
    </div>

    <script>
        class ShipOfTheseusRPG {
            constructor() {
                this.gameState = {
                    currentDay: 1,
                    funds: 1000,
                    crew: 10,
                    reputation: 50,
                    philosophyPoints: 0,
                    gameOver: false,
                    victory: false
                };

                this.shipParts = [
                    { id: "hull", name: "Hull", condition: 80, isOriginal: true, description: "The main body of the ship", cssClass: "hull" },
                    { id: "mast", name: "Mast", condition: 70, isOriginal: true, description: "Supports the sails", cssClass: "mast" },
                    { id: "sails", name: "Sails", condition: 60, isOriginal: true, description: "Catches the wind", cssClass: "sails" },
                    { id: "bow", name: "Bow", condition: 75, isOriginal: true, description: "Front of the ship", cssClass: "bow" },
                    { id: "deck", name: "Deck", condition: 90, isOriginal: true, description: "Walking surface", cssClass: "deck" },
                    { id: "cabin", name: "Cabin", condition: 55, isOriginal: true, description: "Living quarters", cssClass: "cabin" }
                ];

                this.currentEvent = null;
                this.gameLog = ["Welcome to the Ship of Theseus RPG! Your journey begins..."];
                this.showPhilosophy = false;
                this.animatingPart = null;

                this.philosophicalQuestions = [
                    "Click on ship parts to replace them. But ask yourself: when does it stop being the original ship?",
                    "You've replaced your first part. The ship looks slightly different. Is it still the same vessel?",
                    "Two parts replaced. The ship feels different. What makes a ship... a ship?",
                    "Half the ship has been renewed. The old wood rots, the new wood stands strong. Which is real?",
                    "Most parts are new now. The ship sails differently. Do the memories matter?",
                    "Only one original part remains. What essence of the original ship persists?",
                    "Every part has been replaced. The ship looks identical, but nothing is original. Is this the same ship?"
                ];

                this.init();
            }

            init() {
                this.render();
            }

            addToLog(message) {
                this.gameLog.push(message);
                if (this.gameLog.length > 5) {
                    this.gameLog = this.gameLog.slice(-5);
                }
                this.render();
            }

            updateGameState(updates) {
                this.gameState = { ...this.gameState, ...updates };
                this.render();
            }

            replacePart(partId) {
                const part = this.shipParts.find(p => p.id === partId);
                if (!part || !part.isOriginal) return;

                if (this.gameState.funds < 200) {
                    this.addToLog("Not enough funds to replace this part!");
                    return;
                }

                this.animatingPart = partId;
                setTimeout(() => {
                    this.animatingPart = null;
                    this.render();
                }, 2000);

                part.condition = 100;
                part.isOriginal = false;

                this.updateGameState({
                    funds: this.gameState.funds - 200,
                    philosophyPoints: this.gameState.philosophyPoints + 1
                });

                this.addToLog(`Replaced the ${part.name} with a new one.`);
            }

            repairPart(partId) {
                const part = this.shipParts.find(p => p.id === partId);
                if (!part) return;

                if (this.gameState.funds < 100) {
                    this.addToLog("Not enough funds to repair this part!");
                    return;
                }

                if (part.condition >= 90) {
                    this.addToLog(`The ${part.name} is already in excellent condition!`);
                    return;
                }

                part.condition = Math.min(100, part.condition + 30);

                this.updateGameState({ funds: this.gameState.funds - 100 });
                this.addToLog(`Repaired the ${part.name}.`);
            }

            getRandomEvent() {
                const events = [
                    {
                        id: "storm",
                        title: "⛈️ Fierce Storm",
                        description: "A violent storm damages your ship! The crew looks to you for guidance.",
                        choices: [
                            {
                                text: "Replace all damaged parts immediately",
                                effect: () => {
                                    const damagedParts = this.shipParts.filter(p => p.condition < 70);
                                    damagedParts.forEach(part => {
                                        if (part.isOriginal) {
                                            this.replacePart(part.id);
                                        }
                                    });
                                    this.updateGameState({ reputation: this.gameState.reputation + 10 });
                                    this.addToLog("Crew morale is high after quick repairs!");
                                }
                            },
                            {
                                text: "Repair what we can with original materials",
                                effect: () => {
                                    this.shipParts.forEach(part => {
                                        if (part.condition < 70) {
                                            this.repairPart(part.id);
                                        }
                                    });
                                    this.updateGameState({ philosophyPoints: this.gameState.philosophyPoints - 1 });
                                    this.addToLog("Preserved the ship's original character.");
                                }
                            },
                            {
                                text: "Continue sailing, ignore the damage",
                                effect: () => {
                                    this.shipParts.forEach(part => {
                                        part.condition = Math.max(0, part.condition - 20);
                                    });
                                    this.updateGameState({ reputation: this.gameState.reputation - 15 });
                                    this.addToLog("The crew questions your leadership...");
                                }
                            }
                        ]
                    },
                    {
                        id: "merchant",
                        title: "🏺 Traveling Merchant",
                        description: "A merchant offers to buy parts of your ship for a good price, claiming they're historically valuable.",
                        choices: [
                            {
                                text: "Sell original parts for high profit",
                                effect: () => {
                                    this.updateGameState({
                                        funds: this.gameState.funds + 500,
                                        philosophyPoints: this.gameState.philosophyPoints + 2
                                    });
                                    this.addToLog("Sold original parts - but are we still the same ship?");
                                }
                            },
                            {
                                text: "Keep all original parts",
                                effect: () => {
                                    this.updateGameState({ philosophyPoints: this.gameState.philosophyPoints - 1 });
                                    this.addToLog("Preserved the ship's authenticity.");
                                }
                            }
                        ]
                    },
                    {
                        id: "philosopher",
                        title: "🤔 Visiting Philosopher",
                        description: "A philosopher boards your ship and questions the nature of identity. 'If you replace every part, is it still the same ship?'",
                        choices: [
                            {
                                text: "The ship's identity lies in its physical parts",
                                effect: () => {
                                    this.updateGameState({ philosophyPoints: this.gameState.philosophyPoints - 2 });
                                    this.addToLog("Embraced materialism - original parts matter most.");
                                }
                            },
                            {
                                text: "The ship's identity lies in its function and purpose",
                                effect: () => {
                                    this.updateGameState({ philosophyPoints: this.gameState.philosophyPoints + 1 });
                                    this.addToLog("Embraced functionalism - what matters is what it does.");
                                }
                            },
                            {
                                text: "The ship's identity is in the memories and experiences",
                                effect: () => {
                                    this.updateGameState({
                                        philosophyPoints: this.gameState.philosophyPoints + 2,
                                        reputation: this.gameState.reputation + 5
                                    });
                                    this.addToLog("Embraced experiential identity - it's about the journey.");
                                }
                            }
                        ]
                    }
                ];

                return events[Math.floor(Math.random() * events.length)];
            }

            nextDay() {
                // Natural wear and tear
                this.shipParts.forEach(part => {
                    part.condition = Math.max(0, part.condition - Math.random() * 10);
                });

                // Random events
                if (Math.random() < 0.4) {
                    this.currentEvent = this.getRandomEvent();
                }

                // Daily costs
                this.updateGameState({
                    currentDay: this.gameState.currentDay + 1,
                    funds: this.gameState.funds - 50
                });

                // Check win/lose conditions
                const totalCondition = this.shipParts.reduce((sum, part) => sum + part.condition, 0);
                const averageCondition = totalCondition / this.shipParts.length;

                if (averageCondition < 20 || this.gameState.funds < 0) {
                    this.updateGameState({ gameOver: true });
                    this.addToLog("Game Over! Your ship has fallen into disrepair or you've run out of funds.");
                } else if (this.gameState.currentDay >= 30 && averageCondition > 70) {
                    this.updateGameState({ victory: true });
                    this.addToLog("Victory! You've successfully maintained the ship for 30 days!");
                }
            }

            restoreShip() {
                this.shipParts.forEach(part => {
                    part.isOriginal = true;
                });
                this.addToLog("Restored all original parts through mysterious means...");
                this.render();
            }

            togglePhilosophy() {
                this.showPhilosophy = !this.showPhilosophy;
                this.render();
            }

            chooseEventOption(choice) {
                choice.effect();
                this.currentEvent = null;
                this.render();
            }

            restart() {
                location.reload();
            }

            getOriginalPartsCount() {
                return this.shipParts.filter(part => part.isOriginal).length;
            }

            getReplacedPartsCount() {
                return this.shipParts.length - this.getOriginalPartsCount();
            }

            getIdentityPercentage() {
                return (this.getOriginalPartsCount() / this.shipParts.length) * 100;
            }

            getPhilosophyStatus() {
                if (this.gameState.philosophyPoints > 5) return "Ship of Change";
                if (this.gameState.philosophyPoints < -5) return "Ship of Tradition";
                return "Ship in Balance";
            }

            getCurrentQuestion() {
                const replacedCount = this.getReplacedPartsCount();
                return this.philosophicalQuestions[Math.min(replacedCount, this.philosophicalQuestions.length - 1)];
            }

            getShipStatus() {
                const replacedCount = this.getReplacedPartsCount();
                if (replacedCount === 0) return "Ancient";
                if (replacedCount <= 2) return "Weathered";
                if (replacedCount <= 4) return "Renewed";
                return "Transformed";
            }

            render() {
                const container = document.getElementById('gameContainer');

                if (this.gameState.gameOver || this.gameState.victory) {
                    container.innerHTML = this.renderGameOver();
                } else {
                    container.innerHTML = this.renderGame();
                }

                this.bindEvents();
            }

            renderGameOver() {
                return `
                    <div class="card game-over-card">
                        <h1 class="title">
                            ${this.gameState.victory ? "🏆 Victory!" : "💀 Game Over"}
                        </h1>
                        <p class="subtitle">
                            ${this.gameState.victory
                        ? "You successfully navigated the philosophical waters!"
                        : "The ship of Theseus has met its end..."}
                        </p>
                        <div class="game-over-stats">
                            <div>
                                <p style="font-weight: 600; color: var(--text-slate-300);">Days Survived</p>
                                <p style="font-size: 1.5rem; color: var(--amber-400);">${this.gameState.currentDay}</p>
                            </div>
                            <div>
                                <p style="font-weight: 600; color: var(--text-slate-300);">Original Parts</p>
                                <p style="font-size: 1.5rem; color: var(--amber-400);">${this.getOriginalPartsCount()}/6</p>
                            </div>
                            <div>
                                <p style="font-weight: 600; color: var(--text-slate-300);">Philosophy</p>
                                <p style="font-size: 1.125rem; color: var(--amber-400);">${this.getPhilosophyStatus()}</p>
                            </div>
                            <div>
                                <p style="font-weight: 600; color: var(--text-slate-300);">Final Reputation</p>
                                <p style="font-size: 1.5rem; color: var(--amber-400);">${this.gameState.reputation}</p>
                            </div>
                        </div>
                        <button class="button button-primary" onclick="game.restart()" style="margin-top: 1.5rem;">
                            🚢 Sail Again
                        </button>
                    </div>
                `;
            }

            renderGame() {
                return `
                    ${this.renderHeader()}
                    ${this.renderShipVisualization()}
                    ${this.renderGameStats()}
                    ${this.currentEvent ? this.renderCurrentEvent() : ''}
                    ${this.renderGameContent()}
                `;
            }

            renderHeader() {
                return `
                    <div class="card">
                        <h1 class="title">🚢 The Ship of Theseus</h1>
                        <p class="subtitle">If you replace every part of a ship, is it still the same ship?</p>
                    </div>
                `;
            }

            renderShipVisualization() {
                return `
                    <div class="card">
                        <h2 style="color: var(--text-white); text-align: center; margin-bottom: 1rem;">Your Ship</h2>
                        <p style="color: var(--text-slate-300); text-align: center; margin-bottom: 1.5rem;">
                            ${this.getCurrentQuestion()}
                        </p>
                        
                        <div class="ship-container">
                            <div class="waves">
                                <div class="wave"></div>
                                <div class="wave"></div>
                                <div class="wave"></div>
                            </div>
                            <div class="water"></div>
                            <div class="ship">
                                ${this.shipParts.map(part => `
                                    <div 
                                        class="ship-part ${part.isOriginal ? 'original' : 'replaced'} ${part.cssClass} ${this.animatingPart === part.id ? 'animating' : ''}"
                                        onclick="game.replacePart('${part.id}')"
                                        title="${part.name}: ${part.condition.toFixed(0)}% condition"
                                    ></div>
                                `).join('')}
                            </div>
                        </div>

                        <div class="identity-meter">
                            <div class="identity-labels">
                                <span>Ship Identity</span>
                                <span>${this.getIdentityPercentage().toFixed(0)}% Original</span>
                            </div>
                            <div class="identity-bar">
                                <div class="identity-fill" style="width: ${this.getIdentityPercentage()}%"></div>
                            </div>
                        </div>

                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-label">Original Parts</div>
                                <div class="stat-value" style="color: var(--amber-400);">${this.getOriginalPartsCount()}</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">Replaced Parts</div>
                                <div class="stat-value" style="color: var(--blue-400);">${this.getReplacedPartsCount()}</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">Ship Status</div>
                                <div class="stat-value" style="color: var(--green-400);">${this.getShipStatus()}</div>
                            </div>
                        </div>
                    </div>
                `;
            }

            renderGameStats() {
                return `
                    <div class="game-stats">
                        <div class="card game-stat">
                            <div class="game-stat-label">Day</div>
                            <div class="game-stat-value">${this.gameState.currentDay}</div>
                        </div>
                        <div class="card game-stat">
                            <div class="game-stat-label">Funds</div>
                            <div class="game-stat-value" style="color: var(--amber-400);">${this.gameState.funds}💰</div>
                        </div>
                        <div class="card game-stat">
                            <div class="game-stat-label">Reputation</div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${this.gameState.reputation}%"></div>
                            </div>
                            <div style="font-size: 0.875rem; color: var(--text-slate-300); margin-top: 0.5rem;">${this.gameState.reputation}/100</div>
                        </div>
                        <div class="card game-stat">
                            <div class="game-stat-label">Crew Morale</div>
                            <div class="game-stat-value" style="color: var(--green-400);">${this.gameState.crew}</div>
                        </div>
                        <div class="card game-stat">
                            <div class="game-stat-label">Philosophy</div>
                            <div class="badge badge-philosophy">${this.getPhilosophyStatus()}</div>
                        </div>
                    </div>
                `;
            }

            renderCurrentEvent() {
                return `
                    <div class="card event-card">
                        <h3 class="event-title" style="margin-bottom: 0.5rem;">${this.currentEvent.title}</h3>
                        <p class="event-description" style="margin-bottom: 1rem;">${this.currentEvent.description}</p>
                        <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                            ${this.currentEvent.choices.map((choice, index) => `
                                <button class="button choice-button" onclick="game.chooseEventOption(this.currentEvent.choices[${index}])">
                                    ${choice.text}
                                </button>
                            `).join('')}
                        </div>
                    </div>
                `;
            }

            renderGameContent() {
                return `
                    <div class="two-columns">
                        ${this.renderShipManagement()}
                        ${this.renderCaptainsLog()}
                    </div>
                `;
            }

            renderShipManagement() {
                return `
                    <div class="card">
                        <h3 style="color: var(--text-white); margin-bottom: 0.5rem;">Ship Management</h3>
                        <p style="color: var(--text-slate-300); margin-bottom: 1rem;">Monitor and maintain your ship's parts</p>
                        <div class="ship-management">
                            ${this.shipParts.map(part => `
                                <div class="part-container">
                                    <div class="part-header">
                                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                                            <span class="part-name">${part.name}</span>
                                            <span class="badge ${part.isOriginal ? 'badge-secondary' : 'badge-outline'}">
                                                ${part.isOriginal ? 'Original' : 'Replaced'}
                                            </span>
                                        </div>
                                        <span class="part-condition ${part.condition > 70 ? 'condition-good' : part.condition > 30 ? 'condition-medium' : 'condition-bad'}">
                                            ${part.condition.toFixed(0)}%
                                        </span>
                                    </div>
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: ${part.condition}%; background-color: ${part.condition > 70 ? 'var(--green-400)' : part.condition > 30 ? '#eab308' : '#ef4444'};"></div>
                                    </div>
                                    <div class="part-buttons">
                                        <button 
                                            class="button button-sm repair-button" 
                                            onclick="game.repairPart('${part.id}')"
                                            ${this.gameState.funds < 100 || part.condition >= 90 ? 'disabled' : ''}
                                        >
                                            🔧 Repair (100💰)
                                        </button>
                                        <button 
                                            class="button button-sm replace-button" 
                                            onclick="game.replacePart('${part.id}')"
                                            ${this.gameState.funds < 200 || !part.isOriginal ? 'disabled' : ''}
                                        >
                                            🔄 Replace (200💰)
                                        </button>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }

            renderCaptainsLog() {
                return `
                    <div class="card">
                        <h3 style="color: var(--text-white); margin-bottom: 0.5rem;">Captain's Log</h3>
                        <p style="color: var(--text-slate-300); margin-bottom: 1rem;">Recent events and decisions</p>
                        
                        <div class="log-container">
                            ${this.gameLog.map(entry => `<div class="log-entry">${entry}</div>`).join('')}
                        </div>

                        <div class="separator"></div>

                        <div style="display: flex; flex-direction: column; gap: 1rem;">
                            <button 
                                class="button button-primary button-full" 
                                onclick="game.nextDay()"
                                ${this.currentEvent ? 'disabled' : ''}
                            >
                                ${this.currentEvent ? "Resolve Event First" : "⏰ Next Day"}
                            </button>
                            
                            <div class="control-grid">
                                <button class="button control-button control-amber" onclick="game.restoreShip()">
                                    🔄 Restore Ship
                                </button>
                                <button class="button control-button control-purple" onclick="game.togglePhilosophy()">
                                    🤔 Philosophy
                                </button>
                            </div>
                        </div>

                        ${this.showPhilosophy ? this.renderPhilosophyPanel() : ''}
                    </div>
                `;
            }

            renderPhilosophyPanel() {
                return `
                    <div class="card philosophy-panel">
                        <h4 class="philosophy-title">The Ship of Theseus Paradox</h4>
                        <p class="philosophy-text">
                            If you replace every part of a ship, is it still the same ship?
                        </p>
                        <ul class="philosophy-list">
                            <li>• <strong class="philosophy-materialist">Materialists:</strong> Original parts define identity</li>
                            <li>• <strong class="philosophy-functionalist">Functionalists:</strong> Purpose and function matter most</li>
                            <li>• <strong class="philosophy-experientialist">Experientialists:</strong> Memories and journey create identity</li>
                        </ul>
                    </div>
                `;
            }

            bindEvents() {
                // Event choices need to be bound after render since they reference the current event
                if (this.currentEvent) {
                    const choiceButtons = document.querySelectorAll('.choice-button');
                    choiceButtons.forEach((button, index) => {
                        button.onclick = () => this.chooseEventOption(this.currentEvent.choices[index]);
                    });
                }
            }
        }

        // Initialize the game
        const game = new ShipOfTheseusRPG();
    </script>
</body>

</html>